<!DOCTYPE html>
<html lang='en-us'>
<head>
    <meta charset="utf-8">
    <title>Track User&#39;s Location and Display it on Google Maps | rachel&#39;s blog</title>
    <meta name="description" content="We&#39;ll learn on how to track user&#39;s location using the Geolocation API and display it on Google Maps.">
    <meta name="viewport" content="width=device-width, initial-scale=1"><meta property="og:title" content="Track User&#39;s Location and Display it on Google Maps" />
<meta property="og:description" content="We&#39;ll learn on how to track user&#39;s location using the Geolocation API and display it on Google Maps." />
<meta property="og:type" content="article" />
<meta property="og:url" content="/code/track-user-location-google-maps/" /><meta property="og:image" content="/code/track-user-location-google-maps/og.jpg" /><meta property="article:section" content="code" />
<meta property="article:published_time" content="2018-03-16T17:57:00&#43;02:00" />
<meta property="article:modified_time" content="2018-03-16T17:57:00&#43;02:00" /><meta property="og:site_name" content="Software Engineering" />

<meta name="twitter:card" content="summary_large_image"/>
<meta name="twitter:image" content="/code/track-user-location-google-maps/og.jpg"/>

<meta name="twitter:title" content="Track User&#39;s Location and Display it on Google Maps"/>
<meta name="twitter:description" content="We&#39;ll learn on how to track user&#39;s location using the Geolocation API and display it on Google Maps."/>
<link rel="sitemap" type="application/xml" href="/sitemap.xml">
    <link rel="stylesheet" href="/styles.min.9606769ff64b7bcb06eaeff008d91ef001a5fffd74383d9b698531628b2f525e.css">
    <link rel=icon href='data:image/svg+xml,<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 100 100"><text y=".9em" font-size="90">üç£</text></svg>'></head>
<body>
<header>
    <a href="/" class='blog-title'>
       
        <h1>blog.</h1>
    </a>
    <nav>
        <a href="/categories/">Categories</a>
        
        <a href="/about/">About</a>
    </nav>
</header>
<main>
<article>
    <h1 class='article-title'>Track User&#39;s Location and Display it on Google Maps</h1><time datetime='2018-03-16T17:57:00&#43;02:00'>2018-03-16</time><p>This is actually my answer to someone&rsquo;s question on <a href="https://www.facebook.com/groups/35688476100/">PHP Indonesia</a> Facebook group. How can we track user&rsquo;s location continuously using the Geolocation API and display it on Google Maps?</p>
<p>Before getting started, we&rsquo;re going to need an <a href="https://developers.google.com/maps/documentation/javascript/get-api-key">API Key</a> to use the Google Maps JavaScript API. As a safety measure, don&rsquo;t forget to set the HTTP referrers on your API key to your own domains.</p>
<h2>Table of Contents</h2>
<nav id="TableOfContents">
  <ul>
    <li><a href="#displaying-google-map-on-your-page">Displaying Google Map on Your Page</a>
      <ul>
        <li><a href="#our-html-structure">Our HTML Structure</a></li>
        <li><a href="#add-some-styles">Add Some Styles</a></li>
        <li><a href="#initialize-the-map">Initialize The Map</a></li>
      </ul>
    </li>
    <li><a href="#adding-marker-to-your-map">Adding Marker to Your Map</a></li>
    <li><a href="#get-users-location">Get User&rsquo;s Location</a>
      <ul>
        <li><a href="#using-the-getcurrentposition-method">Using the getCurrentPosition Method</a></li>
        <li><a href="#simulating-users-location-on-chrome">Simulating User&rsquo;s Location on Chrome</a></li>
        <li><a href="#handling-errors">Handling Errors</a></li>
        <li><a href="#display-users-location-on-google-maps">Display User&rsquo;s Location on Google Maps</a></li>
        <li><a href="#lets-refactor-our-code">Let&rsquo;s Refactor our Code</a></li>
      </ul>
    </li>
    <li><a href="#track-users-location-with-watchposition">Track User&rsquo;s Location with watchPosition</a>
      <ul>
        <li><a href="#the-positionoptions">The PositionOptions</a></li>
        <li><a href="#the-final-touch">The Final Touch</a></li>
      </ul>
    </li>
  </ul>
</nav>

<h2 id="displaying-google-map-on-your-page">Displaying Google Map on Your Page</h2>
<p>First, let&rsquo;s start with a simple example: display a map on our HTML page using Google Maps Javascript API.</p>
<h3 id="our-html-structure">Our HTML Structure</h3>
<p>Create a new file and put the following HTML structure:</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-html" data-lang="html"><span style="color:#ff79c6">&lt;!doctype html&gt;</span>
&lt;<span style="color:#ff79c6">html</span> <span style="color:#50fa7b">lang</span><span style="color:#ff79c6">=</span><span style="color:#f1fa8c">&#34;en&#34;</span>&gt;
  &lt;<span style="color:#ff79c6">head</span>&gt;
    &lt;<span style="color:#ff79c6">meta</span> <span style="color:#50fa7b">charset</span><span style="color:#ff79c6">=</span><span style="color:#f1fa8c">&#34;utf-8&#34;</span>&gt;
    &lt;<span style="color:#ff79c6">meta</span> <span style="color:#50fa7b">http-equiv</span><span style="color:#ff79c6">=</span><span style="color:#f1fa8c">&#34;x-ua-compatible&#34;</span> <span style="color:#50fa7b">content</span><span style="color:#ff79c6">=</span><span style="color:#f1fa8c">&#34;ie=edge&#34;</span>&gt;
    &lt;<span style="color:#ff79c6">title</span>&gt;üåè Google Maps Geolocation Example&lt;/<span style="color:#ff79c6">title</span>&gt;
    &lt;<span style="color:#ff79c6">meta</span> <span style="color:#50fa7b">name</span><span style="color:#ff79c6">=</span><span style="color:#f1fa8c">&#34;viewport&#34;</span> <span style="color:#50fa7b">content</span><span style="color:#ff79c6">=</span><span style="color:#f1fa8c">&#34;width=device-width, initial-scale=1, shrink-to-fit=no&#34;</span>&gt;
    &lt;<span style="color:#ff79c6">link</span> <span style="color:#50fa7b">rel</span><span style="color:#ff79c6">=</span><span style="color:#f1fa8c">&#34;stylesheet&#34;</span> <span style="color:#50fa7b">href</span><span style="color:#ff79c6">=</span><span style="color:#f1fa8c">&#34;styles.css&#34;</span>&gt;
  &lt;/<span style="color:#ff79c6">head</span>&gt;
  &lt;<span style="color:#ff79c6">body</span>&gt;
    &lt;<span style="color:#ff79c6">main</span> <span style="color:#50fa7b">class</span><span style="color:#ff79c6">=</span><span style="color:#f1fa8c">&#34;container&#34;</span>&gt;
      &lt;<span style="color:#ff79c6">div</span> <span style="color:#50fa7b">id</span><span style="color:#ff79c6">=</span><span style="color:#f1fa8c">&#34;map&#34;</span> <span style="color:#50fa7b">class</span><span style="color:#ff79c6">=</span><span style="color:#f1fa8c">&#34;map&#34;</span>&gt;&lt;/<span style="color:#ff79c6">div</span>&gt;
    &lt;/<span style="color:#ff79c6">main</span>&gt;

    &lt;<span style="color:#ff79c6">script</span> <span style="color:#50fa7b">src</span><span style="color:#ff79c6">=</span><span style="color:#f1fa8c">&#34;script.js&#34;</span>&gt;&lt;/<span style="color:#ff79c6">script</span>&gt;
    &lt;<span style="color:#ff79c6">script</span> <span style="color:#50fa7b">async</span> <span style="color:#50fa7b">defer</span> <span style="color:#50fa7b">src</span><span style="color:#ff79c6">=</span><span style="color:#f1fa8c">&#34;https://maps.googleapis.com/maps/api/js?key=YOUR_API_KEY&amp;callback=init&#34;</span>&gt;&lt;/<span style="color:#ff79c6">script</span>&gt;
  &lt;/<span style="color:#ff79c6">body</span>&gt;
&lt;/<span style="color:#ff79c6">html</span>&gt;
</code></pre></div><p>Safe it as <code>index.html</code>. Don&rsquo;t worry about the <code>styles.css</code> and <code>script.js</code>, we&rsquo;ll create these files later.</p>
<p>The <code>div</code> with the id of <code>map</code> is where we&rsquo;ll load the map. Also, don&rsquo;t forget to replace the <code>YOUR_API_KEY</code> part with your own API key from Google.</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-html" data-lang="html">&lt;<span style="color:#ff79c6">script</span> <span style="color:#50fa7b">async</span> <span style="color:#50fa7b">defer</span> <span style="color:#50fa7b">src</span><span style="color:#ff79c6">=</span><span style="color:#f1fa8c">&#34;https://maps.googleapis.com/maps/api/js?key=YOUR_API_KEY&amp;callback=init&#34;</span>&gt;&lt;/<span style="color:#ff79c6">script</span>&gt;
</code></pre></div><p>The optional <code>callback</code> property is where we can define which function to call once the Google Maps JavaScript API is loaded. In our case it&rsquo;s the <code>init</code> function, we&rsquo;ll define it later.</p>
<h3 id="add-some-styles">Add Some Styles</h3>
<p>Next, let&rsquo;s add some styles to our HTML page. Create a new CSS file and put the following CSS rules:</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-css" data-lang="css"><span style="color:#ff79c6">html</span> {
    <span style="color:#ff79c6">font-family</span>: <span style="color:#ff79c6">sans-serif</span>;
    <span style="color:#ff79c6">line-height</span>: <span style="color:#bd93f9">1.15</span>;
    <span style="color:#ff79c6">height</span>: <span style="color:#bd93f9">100</span><span style="color:#8be9fd">%</span>;
}

<span style="color:#ff79c6">body</span> {
    <span style="color:#ff79c6">margin</span>: <span style="color:#bd93f9">0</span>;
    <span style="color:#ff79c6">font-family</span>: <span style="color:#ff79c6">-</span>apple-system, BlinkMacSystemFont, <span style="color:#f1fa8c">&#34;Segoe UI&#34;</span>, Roboto, <span style="color:#f1fa8c">&#34;Helvetica Neue&#34;</span>, Arial, <span style="color:#ff79c6">sans-serif</span>, <span style="color:#f1fa8c">&#34;Apple Color Emoji&#34;</span>, <span style="color:#f1fa8c">&#34;Segoe UI Emoji&#34;</span>, <span style="color:#f1fa8c">&#34;Segoe UI Symbol&#34;</span>;
    <span style="color:#ff79c6">font-size</span>: <span style="color:#bd93f9">1</span><span style="color:#8be9fd">rem</span>;
    <span style="color:#ff79c6">font-weight</span>: <span style="color:#bd93f9">400</span>;
    <span style="color:#ff79c6">line-height</span>: <span style="color:#bd93f9">1.5</span>;
    <span style="color:#ff79c6">color</span>: <span style="color:#bd93f9">#1a1a1a</span>;
    <span style="color:#ff79c6">text-align</span>: <span style="color:#ff79c6">left</span>;
    <span style="color:#ff79c6">height</span>: <span style="color:#bd93f9">100</span><span style="color:#8be9fd">%</span>;
    <span style="color:#ff79c6">background-color</span>: <span style="color:#bd93f9">#fff</span>;
}

.<span style="color:#50fa7b">container</span> {
    <span style="color:#ff79c6">display</span>: <span style="color:#ff79c6">flex</span>;
    <span style="color:#ff79c6">flex-direction</span>: <span style="color:#ff79c6">column</span>;
    <span style="color:#ff79c6">height</span>: <span style="color:#bd93f9">100</span><span style="color:#8be9fd">%</span>;
}

.<span style="color:#50fa7b">map</span> {
    <span style="color:#ff79c6">flex</span>: <span style="color:#bd93f9">1</span>;
    <span style="color:#ff79c6">background</span>: <span style="color:#bd93f9">#f0f0f0</span>;
}
</code></pre></div><p>Save this file as <code>styles.css</code>. This CSS file simply to make our map&rsquo;s <code>div</code> occupies the whole screen. We achieve this through <a href="https://developer.mozilla.org/en-US/docs/Web/CSS/flex">flexbox</a>:</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-css" data-lang="css"><span style="color:#ff79c6">html</span> {
    <span style="color:#ff79c6">height</span>: <span style="color:#bd93f9">100</span><span style="color:#8be9fd">%</span>;
}

<span style="color:#ff79c6">body</span> {
    <span style="color:#ff79c6">height</span>: <span style="color:#bd93f9">100</span><span style="color:#8be9fd">%</span>;
}

.<span style="color:#50fa7b">container</span> {
    <span style="color:#ff79c6">display</span>: <span style="color:#ff79c6">flex</span>;
    <span style="color:#ff79c6">flex-direction</span>: <span style="color:#ff79c6">column</span>;
    <span style="color:#ff79c6">height</span>: <span style="color:#bd93f9">100</span><span style="color:#8be9fd">%</span>;
}

.<span style="color:#50fa7b">map</span> {
    <span style="color:#ff79c6">flex</span>: <span style="color:#bd93f9">1</span>;
}
</code></pre></div><h3 id="initialize-the-map">Initialize The Map</h3>
<p>Now, all we have to do is create a new JavaScript file for displaying the map. Type the following codes and save it as <code>script.js</code>.</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-js" data-lang="js"><span style="color:#8be9fd;font-style:italic">function</span> init() {
  <span style="color:#ff79c6">new</span> google.maps.Map(<span style="color:#8be9fd;font-style:italic">document</span>.getElementById(<span style="color:#f1fa8c">&#39;map&#39;</span>), {
    center<span style="color:#ff79c6">:</span> { lat<span style="color:#ff79c6">:</span> <span style="color:#bd93f9">59.325</span>, lng<span style="color:#ff79c6">:</span> <span style="color:#bd93f9">18.069</span> },
    zoom<span style="color:#ff79c6">:</span> <span style="color:#bd93f9">15</span>
  });
}
</code></pre></div><p>This <code>init()</code> function will be automatically invoked once the Google Maps JavaScript API is loaded. Inside this function we create a new <a href="https://developers.google.com/maps/documentation/javascript/reference/3/#Map">Map</a> instance:</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-js" data-lang="js"><span style="color:#ff79c6">new</span> google.maps.Map(element, options);
</code></pre></div><p>The first parameter is the DOM element where the map will be displayed. In our case, it&rsquo;s the <code>div</code> with the id of <code>map</code>. The second parameter is our map configuration object. The <code>center</code> property defines the initial coordinate of our map&rsquo;s center. The <code>zoom</code> property defines the initial zoom level. You can read more about other options in <a href="https://developers.google.com/maps/documentation/javascript/reference/3/#MapOptions">Map Options Documentation</a>.</p>
<p>Now if we open up our page in the browser, we should see our map is successfully loaded like this:</p>
<p><figure>
    <a href="01-google-maps.png"><img src="/code/track-user-location-google-maps/01-google-maps.png" alt="Our map is loaded on the page">
    </a><figcaption>Our map is loaded on the page</figcaption></figure>
</p>
<h2 id="adding-marker-to-your-map">Adding Marker to Your Map</h2>
<p>Our next step is to learn how to add a marker to our map instance. Open the <code>script.js</code> file and modify it like so:</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-js" data-lang="js"><span style="color:#8be9fd;font-style:italic">function</span> init() {
  <span style="color:#ff79c6">const</span> initialPosition <span style="color:#ff79c6">=</span> { lat<span style="color:#ff79c6">:</span> <span style="color:#bd93f9">59.325</span>, lng<span style="color:#ff79c6">:</span> <span style="color:#bd93f9">18.069</span> };

  <span style="color:#ff79c6">const</span> map <span style="color:#ff79c6">=</span> <span style="color:#ff79c6">new</span> google.maps.Map(<span style="color:#8be9fd;font-style:italic">document</span>.getElementById(<span style="color:#f1fa8c">&#39;map&#39;</span>), {
    center<span style="color:#ff79c6">:</span> initialPosition,
    zoom<span style="color:#ff79c6">:</span> <span style="color:#bd93f9">15</span>
  });

  <span style="color:#ff79c6">const</span> marker <span style="color:#ff79c6">=</span> <span style="color:#ff79c6">new</span> google.maps.Marker({ map, position<span style="color:#ff79c6">:</span> initialPosition });
}
</code></pre></div><p>Within the <code>init</code> function, we add a new statement that will create an instance of <a href="https://developers.google.com/maps/documentation/javascript/reference/3/#Marker">Marker</a> class.</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-js" data-lang="js"><span style="color:#ff79c6">new</span> google.maps.Marker(options);
</code></pre></div><p>It accepts a single argument: an object of marker&rsquo;s options. The <code>map</code> property is where the marker will be displayed, that&rsquo;s why we pass the created <code>Map</code> instance to this property. The <code>position</code> defines the marker&rsquo;s position. Check out all of the available options in <a href="https://developers.google.com/maps/documentation/javascript/reference/3/#MarkerOptions">Marker Options Documentation</a>.</p>
<p>We should now see the marker placed on the map.</p>
<p><figure>
    <a href="02-google-maps-with-marker.png"><img src="/code/track-user-location-google-maps/02-google-maps-with-marker.png" alt="Marker on the map">
    </a><figcaption>Marker on the map</figcaption></figure>
</p>
<h2 id="get-users-location">Get User&rsquo;s Location</h2>
<p>Our next step would be retrieving user&rsquo;s location using the JavaScript <a href="https://developer.mozilla.org/en-US/docs/Web/API/Geolocation/Using_geolocation">Geolocation API</a>.</p>
<h3 id="using-the-getcurrentposition-method">Using the getCurrentPosition Method</h3>
<p>Open up our <code>scripts.js</code> file again. Then add the new code section for retrieving user&rsquo;s location:</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-js" data-lang="js"><span style="color:#8be9fd;font-style:italic">function</span> init() {
  <span style="color:#ff79c6">const</span> initialPosition <span style="color:#ff79c6">=</span> { lat<span style="color:#ff79c6">:</span> <span style="color:#bd93f9">59.325</span>, lng<span style="color:#ff79c6">:</span> <span style="color:#bd93f9">18.069</span> };

  <span style="color:#ff79c6">const</span> map <span style="color:#ff79c6">=</span> <span style="color:#ff79c6">new</span> google.maps.Map(<span style="color:#8be9fd;font-style:italic">document</span>.getElementById(<span style="color:#f1fa8c">&#39;map&#39;</span>), {
    center<span style="color:#ff79c6">:</span> initialPosition,
    zoom<span style="color:#ff79c6">:</span> <span style="color:#bd93f9">15</span>
  });

  <span style="color:#ff79c6">const</span> marker <span style="color:#ff79c6">=</span> <span style="color:#ff79c6">new</span> google.maps.Marker({ map, position<span style="color:#ff79c6">:</span> initialPosition });

  <span style="color:#6272a4">// Get user&#39;s location
</span><span style="color:#6272a4"></span>  <span style="color:#ff79c6">if</span> (<span style="color:#f1fa8c">&#39;geolocation&#39;</span> <span style="color:#ff79c6">in</span> navigator) {
    navigator.geolocation.getCurrentPosition(
      position =&gt; console.log(<span style="color:#f1fa8c">`Lat: </span><span style="color:#f1fa8c">${</span>position.coords.latitude<span style="color:#f1fa8c">}</span><span style="color:#f1fa8c"> Lng: </span><span style="color:#f1fa8c">${</span>position.coords.longitude<span style="color:#f1fa8c">}</span><span style="color:#f1fa8c">`</span>),
      err =&gt; alert(<span style="color:#f1fa8c">`Error (</span><span style="color:#f1fa8c">${</span>err.code<span style="color:#f1fa8c">}</span><span style="color:#f1fa8c">): </span><span style="color:#f1fa8c">${</span>err.message<span style="color:#f1fa8c">}</span><span style="color:#f1fa8c">`</span>)
    );
  } <span style="color:#ff79c6">else</span> {
    alert(<span style="color:#f1fa8c">&#39;Geolocation is not supported by your browser.&#39;</span>);
  }
}
</code></pre></div><p>The following code checks whether the GeoLocation API is supported by the browser. We simply check if the <code>geolocation</code> property exists within the <code>navigator</code> object.</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-js" data-lang="js"><span style="color:#ff79c6">if</span> (<span style="color:#f1fa8c">&#39;geolocation&#39;</span> <span style="color:#ff79c6">in</span> navigator) {
    <span style="color:#6272a4">// Geolocation API is supported
</span><span style="color:#6272a4"></span>} <span style="color:#ff79c6">else</span> {
    <span style="color:#6272a4">// Geolocation API is not supported
</span><span style="color:#6272a4"></span>    alert(<span style="color:#f1fa8c">&#39;Geolocation is not supported by your browser.&#39;</span>);
}
</code></pre></div><p>If the GeoLocation API is supported, we can then safely use the <code>getCurrentPosition()</code> method to retrieve user&rsquo;s location.</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-js" data-lang="js">navigator.geolocation.getCurrentPosition(success, error, [options])
</code></pre></div><p>This method accepts three parameters:</p>
<ul>
<li><code>success</code>: A callback function that will be invoked once the user&rsquo;s location is retrieved successfully. The callback receives a <a href="https://developer.mozilla.org/en-US/docs/Web/API/Position"><code>Position</code></a> object that holds the user&rsquo;s location.</li>
<li><code>error</code>: A callback function that will be invoked if user&rsquo;s location is failed to retrieve. The callback accepts a <a href="https://developer.mozilla.org/en-US/docs/Web/API/PositionError"><code>PositionError</code></a> object.</li>
<li><code>options</code>: Is an optional <a href="https://developer.mozilla.org/en-US/docs/Web/API/PositionOptions"><code>PositionOptions</code></a> object that can be used to configure the retrieval process.</li>
</ul>
<p>Upon successful retrieval, we simply print the user&rsquo;s coordinate. And if it&rsquo;s failed, we show the error message using <code>alert</code>.</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-js" data-lang="js">navigator.geolocation.getCurrentPosition(
  <span style="color:#6272a4">// On success
</span><span style="color:#6272a4"></span>  position =&gt; console.log(<span style="color:#f1fa8c">`Lat: </span><span style="color:#f1fa8c">${</span>position.coords.latitude<span style="color:#f1fa8c">}</span><span style="color:#f1fa8c"> Lng: </span><span style="color:#f1fa8c">${</span>position.coords.longitude<span style="color:#f1fa8c">}</span><span style="color:#f1fa8c">`</span>),
  <span style="color:#6272a4">// On error
</span><span style="color:#6272a4"></span>  err =&gt; alert(<span style="color:#f1fa8c">`Error (</span><span style="color:#f1fa8c">${</span>err.code<span style="color:#f1fa8c">}</span><span style="color:#f1fa8c">): </span><span style="color:#f1fa8c">${</span>err.message<span style="color:#f1fa8c">}</span><span style="color:#f1fa8c">`</span>)
);
</code></pre></div><p>Open our page in the browser. It will ask your permission to get your current location. Click <strong>Allow</strong> to give it permission and proceed.</p>
<p><figure>
    <a href="03-want-to-konw-your-location.png"><img src="/code/track-user-location-google-maps/03-want-to-konw-your-location.png" alt="Permission to get your location">
    </a><figcaption>Permission to get your location</figcaption></figure>
</p>
<blockquote>
<p>‚ö†Ô∏è Geolocation API is only available in HTTPS</p>
<p>Note that this Geolocation API is only available in secure contexts. So you&rsquo;ll need to access your page through HTTPS protocol.</p>
</blockquote>
<p>If it&rsquo;s successful, you&rsquo;ll get your location printed on the console similar to this:</p>
<p><figure>
    <a href="04-location-retrieved-successfully.png"><img src="/code/track-user-location-google-maps/04-location-retrieved-successfully.png" alt="Location is successfully retrieved">
    </a><figcaption>Location is successfully retrieved</figcaption></figure>
</p>
<h3 id="simulating-users-location-on-chrome">Simulating User&rsquo;s Location on Chrome</h3>
<p>On Chrome, we can simulate the user&rsquo;s location. Open up your developer tools. Click on the three-vertical-dots button on the top-right of your developer tools screen. Click on <strong>More tools</strong> &raquo; <strong>Sensors</strong> menu. It will bring a new tab named <strong>Sensors</strong> where you can easily override the position.</p>
<p><figure>
    <a href="05-sensors-tab.png"><img src="/code/track-user-location-google-maps/05-sensors-tab.png" alt="Sensors tab">
    </a><figcaption>Sensors tab</figcaption></figure>
</p>
<p>There&rsquo;s also some presets for various city locations that we can choose from. Select some cities and reload the page, you should get the city&rsquo;s location printed on the console.</p>
<h3 id="handling-errors">Handling Errors</h3>
<p>From the <code>Sensors</code> tab, you can also simulate the position unavailable error. From the drop-down select <code>Location unavailable</code> option and reload the page. You&rsquo;ll get an alert like this:</p>
<p><figure>
    <a href="06-location-unavailable-error.png"><img src="/code/track-user-location-google-maps/06-location-unavailable-error.png" alt="Location unavailable error">
    </a><figcaption>Location unavailable error</figcaption></figure>
</p>
<p>We only got the error <code>code</code>, but the <code>message</code> property is empty. Apparently, the specification already specifies that this <code>message</code> property is for debugging only and not to be shown directly to the user. That&rsquo;s why we should rely on the <code>code</code> and provide our own error message instead.</p>
<p>The <a href="https://developer.mozilla.org/en-US/docs/Web/API/PositionError/code"><code>PositionError.code</code></a> may have the following values:</p>
<ul>
<li><code>1</code>: The permission is denied.</li>
<li><code>2</code>: The position is unavailable, the Geolocation failed to retrieve the user&rsquo;s location.</li>
<li><code>3</code>: Timeout‚Äîwhen the device does not return the user&rsquo;s location within the given <code>timeout</code> option.</li>
</ul>
<p>Let&rsquo;s modify our <code>script.js</code> to print out the appropriate error message:</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-js" data-lang="js"><span style="color:#6272a4">// Get proper error message based on the code.
</span><span style="color:#6272a4"></span><span style="color:#ff79c6">const</span> getPositionErrorMessage <span style="color:#ff79c6">=</span> code =&gt; {
  <span style="color:#ff79c6">switch</span> (code) {
    <span style="color:#ff79c6">case</span> <span style="color:#bd93f9">1</span><span style="color:#ff79c6">:</span>
      <span style="color:#ff79c6">return</span> <span style="color:#f1fa8c">&#39;Permission denied.&#39;</span>;
    <span style="color:#ff79c6">case</span> <span style="color:#bd93f9">2</span><span style="color:#ff79c6">:</span>
      <span style="color:#ff79c6">return</span> <span style="color:#f1fa8c">&#39;Position unavailable.&#39;</span>;
    <span style="color:#ff79c6">case</span> <span style="color:#bd93f9">3</span><span style="color:#ff79c6">:</span>
      <span style="color:#ff79c6">return</span> <span style="color:#f1fa8c">&#39;Timeout reached.&#39;</span>;
  }
}

<span style="color:#8be9fd;font-style:italic">function</span> init() {
  <span style="color:#6272a4">// Omitted for brevity
</span><span style="color:#6272a4"></span>
  <span style="color:#ff79c6">if</span> (<span style="color:#f1fa8c">&#39;geolocation&#39;</span> <span style="color:#ff79c6">in</span> navigator) {
    navigator.geolocation.getCurrentPosition(
      position =&gt; console.log(<span style="color:#f1fa8c">`Lat: </span><span style="color:#f1fa8c">${</span>position.coords.latitude<span style="color:#f1fa8c">}</span><span style="color:#f1fa8c"> Lng: </span><span style="color:#f1fa8c">${</span>position.coords.longitude<span style="color:#f1fa8c">}</span><span style="color:#f1fa8c">`</span>),
      err =&gt; alert(<span style="color:#f1fa8c">`Error (</span><span style="color:#f1fa8c">${</span>err.code<span style="color:#f1fa8c">}</span><span style="color:#f1fa8c">): </span><span style="color:#f1fa8c">${</span>getPositionErrorMessage(err.code)<span style="color:#f1fa8c">}</span><span style="color:#f1fa8c">`</span>)
    );
  } <span style="color:#ff79c6">else</span> {
    alert(<span style="color:#f1fa8c">&#39;Geolocation is not supported by your browser.&#39;</span>);
  }
}
</code></pre></div><p>Now if we select the <code>Location unavailable</code> option from the <strong>Sensors</strong> tab again and reload the page. We should get an alert: <code>Error (2): Position unavailable.</code>.</p>
<h3 id="display-users-location-on-google-maps">Display User&rsquo;s Location on Google Maps</h3>
<p>We successfully retrieved user&rsquo;s location. But our map and marker still displaying the given initial location. Let&rsquo;s modify our <code>script.js</code> file to properly center the map and marker to user&rsquo;s location.</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-js" data-lang="js"><span style="color:#6272a4">// Omitted for brevity
</span><span style="color:#6272a4"></span>
<span style="color:#8be9fd;font-style:italic">function</span> init() {
  <span style="color:#ff79c6">const</span> initialPosition <span style="color:#ff79c6">=</span> { lat<span style="color:#ff79c6">:</span> <span style="color:#bd93f9">59.325</span>, lng<span style="color:#ff79c6">:</span> <span style="color:#bd93f9">18.069</span> };

  <span style="color:#ff79c6">const</span> map <span style="color:#ff79c6">=</span> <span style="color:#ff79c6">new</span> google.maps.Map(<span style="color:#8be9fd;font-style:italic">document</span>.getElementById(<span style="color:#f1fa8c">&#39;map&#39;</span>), {
    center<span style="color:#ff79c6">:</span> initialPosition,
    zoom<span style="color:#ff79c6">:</span> <span style="color:#bd93f9">15</span>
  });

  <span style="color:#ff79c6">const</span> marker <span style="color:#ff79c6">=</span> <span style="color:#ff79c6">new</span> google.maps.Marker({ map, position<span style="color:#ff79c6">:</span> initialPosition });

  <span style="color:#6272a4">// Get user&#39;s location
</span><span style="color:#6272a4"></span>  <span style="color:#ff79c6">if</span> (<span style="color:#f1fa8c">&#39;geolocation&#39;</span> <span style="color:#ff79c6">in</span> navigator) {
    navigator.geolocation.getCurrentPosition(
      position =&gt; {
        console.log(<span style="color:#f1fa8c">`Lat: </span><span style="color:#f1fa8c">${</span>position.coords.latitude<span style="color:#f1fa8c">}</span><span style="color:#f1fa8c"> Lng: </span><span style="color:#f1fa8c">${</span>position.coords.longitude<span style="color:#f1fa8c">}</span><span style="color:#f1fa8c">`</span>);

        <span style="color:#6272a4">// Set marker&#39;s position.
</span><span style="color:#6272a4"></span>        marker.setPosition({
          lat<span style="color:#ff79c6">:</span> position.coords.latitude,
          lng<span style="color:#ff79c6">:</span> position.coords.longitude
        });

        <span style="color:#6272a4">// Center map to user&#39;s position.
</span><span style="color:#6272a4"></span>        map.panTo({
          lat<span style="color:#ff79c6">:</span> position.coords.latitude,
          lng<span style="color:#ff79c6">:</span> position.coords.longitude
        });
      },
      err =&gt; alert(<span style="color:#f1fa8c">`Error (</span><span style="color:#f1fa8c">${</span>err.code<span style="color:#f1fa8c">}</span><span style="color:#f1fa8c">): </span><span style="color:#f1fa8c">${</span>getPositionErrorMessage(err.code)<span style="color:#f1fa8c">}</span><span style="color:#f1fa8c">`</span>)
    );
  } <span style="color:#ff79c6">else</span> {
    alert(<span style="color:#f1fa8c">&#39;Geolocation is not supported by your browser.&#39;</span>);
  }
}
</code></pre></div><p>We use the marker&rsquo;s <code>setPostion()</code> method to change the location of the marker. We pass it an object of the retrieved user&rsquo;s location.</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-js" data-lang="js">marker.setPosition({
  lat<span style="color:#ff79c6">:</span> position.coords.latitude,
  lng<span style="color:#ff79c6">:</span> position.coords.longitude
});
</code></pre></div><p>And we also use the map&rsquo;s <code>panTo()</code> method to center the map to user&rsquo;s location:</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-js" data-lang="js">map.panTo({
  lat<span style="color:#ff79c6">:</span> position.coords.latitude,
  lng<span style="color:#ff79c6">:</span> position.coords.longitude
});
</code></pre></div><p>Now if we load our page, both the map and marker should show the retrieved user&rsquo;s location.</p>
<h3 id="lets-refactor-our-code">Let&rsquo;s Refactor our Code</h3>
<p>Our code now is getting a bit messy. Let&rsquo;s refactor it by extracting each step into its own function.</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-js" data-lang="js"><span style="color:#ff79c6">const</span> createMap <span style="color:#ff79c6">=</span> ({ lat, lng }) =&gt; {
  <span style="color:#ff79c6">return</span> <span style="color:#ff79c6">new</span> google.maps.Map(<span style="color:#8be9fd;font-style:italic">document</span>.getElementById(<span style="color:#f1fa8c">&#39;map&#39;</span>), {
    center<span style="color:#ff79c6">:</span> { lat, lng },
    zoom<span style="color:#ff79c6">:</span> <span style="color:#bd93f9">15</span>
  });
};

<span style="color:#ff79c6">const</span> createMarker <span style="color:#ff79c6">=</span> ({ map, position }) =&gt; {
  <span style="color:#ff79c6">return</span> <span style="color:#ff79c6">new</span> google.maps.Marker({ map, position });
};

<span style="color:#ff79c6">const</span> getCurrentPosition <span style="color:#ff79c6">=</span> ({ onSuccess, onError <span style="color:#ff79c6">=</span> () =&gt; { } }) =&gt; {
  <span style="color:#ff79c6">if</span> (<span style="color:#f1fa8c">&#39;geolocation&#39;</span> <span style="color:#ff79c6">in</span> navigator <span style="color:#ff79c6">===</span> <span style="color:#ff79c6">false</span>) {
    <span style="color:#ff79c6">return</span> onError(<span style="color:#ff79c6">new</span> <span style="color:#8be9fd;font-style:italic">Error</span>(<span style="color:#f1fa8c">&#39;Geolocation is not supported by your browser.&#39;</span>));
  }

  <span style="color:#ff79c6">return</span> navigator.geolocation.getCurrentPosition(onSuccess, onError);
};

<span style="color:#ff79c6">const</span> getPositionErrorMessage <span style="color:#ff79c6">=</span> code =&gt; {
  <span style="color:#ff79c6">switch</span> (code) {
    <span style="color:#ff79c6">case</span> <span style="color:#bd93f9">1</span><span style="color:#ff79c6">:</span>
      <span style="color:#ff79c6">return</span> <span style="color:#f1fa8c">&#39;Permission denied.&#39;</span>;
    <span style="color:#ff79c6">case</span> <span style="color:#bd93f9">2</span><span style="color:#ff79c6">:</span>
      <span style="color:#ff79c6">return</span> <span style="color:#f1fa8c">&#39;Position unavailable.&#39;</span>;
    <span style="color:#ff79c6">case</span> <span style="color:#bd93f9">3</span><span style="color:#ff79c6">:</span>
      <span style="color:#ff79c6">return</span> <span style="color:#f1fa8c">&#39;Timeout reached.&#39;</span>;
    <span style="color:#ff79c6">default</span><span style="color:#ff79c6">:</span>
      <span style="color:#ff79c6">return</span> <span style="color:#ff79c6">null</span>;
  }
}

<span style="color:#8be9fd;font-style:italic">function</span> init() {
  <span style="color:#ff79c6">const</span> initialPosition <span style="color:#ff79c6">=</span> { lat<span style="color:#ff79c6">:</span> <span style="color:#bd93f9">59.325</span>, lng<span style="color:#ff79c6">:</span> <span style="color:#bd93f9">18.069</span> };
  <span style="color:#ff79c6">const</span> map <span style="color:#ff79c6">=</span> createMap(initialPosition);
  <span style="color:#ff79c6">const</span> marker <span style="color:#ff79c6">=</span> createMarker({ map, position<span style="color:#ff79c6">:</span> initialPosition });

  getCurrentPosition({
    onSuccess<span style="color:#ff79c6">:</span> ({ coords<span style="color:#ff79c6">:</span> { latitude<span style="color:#ff79c6">:</span> lat, longitude<span style="color:#ff79c6">:</span> lng } }) =&gt; {
      marker.setPosition({ lat, lng });
      map.panTo({ lat, lng });
    },
    onError<span style="color:#ff79c6">:</span> err =&gt;
      alert(<span style="color:#f1fa8c">`Error: </span><span style="color:#f1fa8c">${</span>getPositionErrorMessage(err.code) <span style="color:#ff79c6">||</span> err.message<span style="color:#f1fa8c">}</span><span style="color:#f1fa8c">`</span>)
  });
}
</code></pre></div><p>We use ES2015 object destructuring to easily get access to <code>position.coords.latitude</code> and <code>position.coords.longitude</code> and rename them <code>lat</code> and <code>lng</code> accordingly:</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-js" data-lang="js">onSuccess<span style="color:#ff79c6">:</span> ({ coords<span style="color:#ff79c6">:</span> { latitude<span style="color:#ff79c6">:</span> lat, longitude<span style="color:#ff79c6">:</span> lng } }) =&gt; {
  <span style="color:#6272a4">//
</span><span style="color:#6272a4"></span>},
</code></pre></div><p>We also pass an <code>Error</code> object when the Geolocation API is not supported.</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-js" data-lang="js"><span style="color:#ff79c6">const</span> getCurrentPosition <span style="color:#ff79c6">=</span> ({ onSuccess, onError <span style="color:#ff79c6">=</span> () =&gt; { } }) =&gt; {
  <span style="color:#ff79c6">if</span> (<span style="color:#f1fa8c">&#39;geolocation&#39;</span> <span style="color:#ff79c6">in</span> navigator <span style="color:#ff79c6">===</span> <span style="color:#ff79c6">false</span>) {
    <span style="color:#6272a4">// Invoke onError callback and pass an error object.
</span><span style="color:#6272a4"></span>    <span style="color:#ff79c6">return</span> onError(<span style="color:#ff79c6">new</span> <span style="color:#8be9fd;font-style:italic">Error</span>(<span style="color:#f1fa8c">&#39;Geolocation is not supported by your browser.&#39;</span>));
  }

  <span style="color:#ff79c6">return</span> navigator.geolocation.getCurrentPosition(onSuccess, onError);
};
</code></pre></div><h2 id="track-users-location-with-watchposition">Track User&rsquo;s Location with watchPosition</h2>
<p>Up until now, we only retrieve user&rsquo;s location once. How can we track user&rsquo;s location continuously? By using <code>setInterval()</code>? Well, we can, but it&rsquo;s not the best solution. To track user&rsquo;s location continuously, we can use the provided <a href="https://developer.mozilla.org/en-US/docs/Web/API/Geolocation/watchPosition"><code>watchPostion()</code></a> method.</p>
<p>Let&rsquo;s modify our <code>script.js</code> file to use the <code>watchPosition</code> instead.</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-js" data-lang="js"><span style="color:#6272a4">// New function to track user&#39;s location.
</span><span style="color:#6272a4"></span><span style="color:#ff79c6">const</span> trackLocation <span style="color:#ff79c6">=</span> ({ onSuccess, onError <span style="color:#ff79c6">=</span> () =&gt; { } }) =&gt; {
  <span style="color:#ff79c6">if</span> (<span style="color:#f1fa8c">&#39;geolocation&#39;</span> <span style="color:#ff79c6">in</span> navigator <span style="color:#ff79c6">===</span> <span style="color:#ff79c6">false</span>) {
    <span style="color:#ff79c6">return</span> onError(<span style="color:#ff79c6">new</span> <span style="color:#8be9fd;font-style:italic">Error</span>(<span style="color:#f1fa8c">&#39;Geolocation is not supported by your browser.&#39;</span>));
  }

  <span style="color:#6272a4">// Use watchPosition instead.
</span><span style="color:#6272a4"></span>  <span style="color:#ff79c6">return</span> navigator.geolocation.watchPosition(onSuccess, onError);
};

<span style="color:#8be9fd;font-style:italic">function</span> init() {
  <span style="color:#ff79c6">const</span> initialPosition <span style="color:#ff79c6">=</span> { lat<span style="color:#ff79c6">:</span> <span style="color:#bd93f9">59.325</span>, lng<span style="color:#ff79c6">:</span> <span style="color:#bd93f9">18.069</span> };
  <span style="color:#ff79c6">const</span> map <span style="color:#ff79c6">=</span> createMap(initialPosition);
  <span style="color:#ff79c6">const</span> marker <span style="color:#ff79c6">=</span> createMarker({ map, position<span style="color:#ff79c6">:</span> initialPosition });

  <span style="color:#6272a4">// Use the new trackLocation function.
</span><span style="color:#6272a4"></span>  trackLocation({
    onSuccess<span style="color:#ff79c6">:</span> ({ coords<span style="color:#ff79c6">:</span> { latitude<span style="color:#ff79c6">:</span> lat, longitude<span style="color:#ff79c6">:</span> lng } }) =&gt; {
      marker.setPosition({ lat, lng });
      map.panTo({ lat, lng });
    },
    onError<span style="color:#ff79c6">:</span> err =&gt;
      alert(<span style="color:#f1fa8c">`Error: </span><span style="color:#f1fa8c">${</span>getPositionErrorMessage(err.code) <span style="color:#ff79c6">||</span> err.message<span style="color:#f1fa8c">}</span><span style="color:#f1fa8c">`</span>)
  });
}
</code></pre></div><p>The <code>watchPosition()</code> will be called every time the position of the device changes. This way we can easily track the user&rsquo;s location.</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-js" data-lang="js">id <span style="color:#ff79c6">=</span> navigator.geolocation.watchPosition(success[, error[, options]])
</code></pre></div><p>The <code>watchPosition()</code> accepts three parameters, it exactly the identical parameters like the one provided for <a href="#using-the-getcurrentposition-Method"><code>getCurrentPosition()</code></a>. The only difference is the <code>error</code> callback is optional for the <code>watchPosition()</code>.</p>
<p>It also returns an <code>id</code> like <code>setTimeout()</code> or <code>setInteval()</code> functions. This <code>id</code> can be used to stop tracking user&rsquo;s location with <a href="https://developer.mozilla.org/en-US/docs/Web/API/Geolocation/clearWatch"><code>clearWatch()</code></a> method.</p>
<p>If we reload our page, both the marker and the map position should now be updated every time the location is changed.</p>
<h3 id="the-positionoptions">The PositionOptions</h3>
<p>Both <code>getCurrentPosition()</code> and <code>watchPosition()</code> accept the optional third parameter. It&rsquo;s an object of <a href="https://developer.mozilla.org/en-US/docs/Web/API/PositionOptions"><code>PositionOptions</code></a>. There are three properties that we can configure:</p>
<ul>
<li><code>enableHighAccuracy</code>: It&rsquo;s a <code>boolean</code> to indicate whether we&rsquo;d like to get the best possible accuracy or not. Enabling this option may result in slower response time and increase power consumption.</li>
<li><code>timeout</code>: It&rsquo;s a <code>long</code> value in milliseconds that will limit the time for a device to return user&rsquo;s location. If the device hasn&rsquo;t returned the location within the specified time, it will throw a timeout error. By default, the value is <code>Infinity</code> which means it will never timeout.</li>
<li><code>maximumAge</code>: It&rsquo;s a <code>long</code> value in milliseconds representing the maximum age of a cached position. By default, it set to <code>0</code> and it means that we don&rsquo;t want the device to use a cached position.</li>
</ul>
<p>Let&rsquo;s configure our <code>trackLocation()</code> function to enable the high accuracy and set a maximum <code>timeout</code> to 5 seconds.</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-js" data-lang="js"><span style="color:#ff79c6">const</span> trackLocation <span style="color:#ff79c6">=</span> ({ onSuccess, onError <span style="color:#ff79c6">=</span> () =&gt; { } }) =&gt; {
  <span style="color:#6272a4">// Omitted for brevity
</span><span style="color:#6272a4"></span>
  <span style="color:#ff79c6">return</span> navigator.geolocation.watchPosition(onSuccess, onError, {
    enableHighAccuracy<span style="color:#ff79c6">:</span> <span style="color:#ff79c6">true</span>,
    timeout<span style="color:#ff79c6">:</span> <span style="color:#bd93f9">5000</span>,
    maximumAge<span style="color:#ff79c6">:</span> <span style="color:#bd93f9">0</span>
  });
};
</code></pre></div><h3 id="the-final-touch">The Final Touch</h3>
<p>For the final touch, let&rsquo;s integrate both the retrieved user&rsquo;s coordinate and any error message into the UI. Open the <code>index.html</code> file and add a new <code>div</code> for displaying this information:</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-html" data-lang="html">&lt;<span style="color:#ff79c6">main</span> <span style="color:#50fa7b">class</span><span style="color:#ff79c6">=</span><span style="color:#f1fa8c">&#34;container&#34;</span>&gt;
    &lt;<span style="color:#ff79c6">div</span> <span style="color:#50fa7b">id</span><span style="color:#ff79c6">=</span><span style="color:#f1fa8c">&#34;map&#34;</span> <span style="color:#50fa7b">class</span><span style="color:#ff79c6">=</span><span style="color:#f1fa8c">&#34;map&#34;</span>&gt;&lt;/<span style="color:#ff79c6">div</span>&gt;
    <span style="color:#6272a4">&lt;!-- For displaying user&#39;s coordinate or error message. --&gt;</span>
    &lt;<span style="color:#ff79c6">div</span> <span style="color:#50fa7b">id</span><span style="color:#ff79c6">=</span><span style="color:#f1fa8c">&#34;info&#34;</span> <span style="color:#50fa7b">class</span><span style="color:#ff79c6">=</span><span style="color:#f1fa8c">&#34;info&#34;</span>&gt;&lt;/<span style="color:#ff79c6">div</span>&gt;
&lt;/<span style="color:#ff79c6">main</span>&gt;
</code></pre></div><p>Now open the <code>styles.css</code> file and add the following rules:</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-css" data-lang="css">.<span style="color:#50fa7b">info</span> {
    <span style="color:#ff79c6">padding</span>: <span style="color:#bd93f9">1</span><span style="color:#8be9fd">rem</span>;
    <span style="color:#ff79c6">margin</span>: <span style="color:#bd93f9">0</span>;
}

.<span style="color:#50fa7b">info</span>.<span style="color:#50fa7b">error</span> {
    <span style="color:#ff79c6">color</span>: <span style="color:#bd93f9">#fff</span>;
    <span style="color:#ff79c6">background</span>: <span style="color:#bd93f9">#dc3545</span>;
}
</code></pre></div><p>Finally, let&rsquo;s update our <code>script.js</code> to print out the coordinate and the error into the <code>#info</code> div.</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-js" data-lang="js"><span style="color:#8be9fd;font-style:italic">function</span> init() {
  <span style="color:#ff79c6">const</span> initialPosition <span style="color:#ff79c6">=</span> { lat<span style="color:#ff79c6">:</span> <span style="color:#bd93f9">59.325</span>, lng<span style="color:#ff79c6">:</span> <span style="color:#bd93f9">18.069</span> };
  <span style="color:#ff79c6">const</span> map <span style="color:#ff79c6">=</span> createMap(initialPosition);
  <span style="color:#ff79c6">const</span> marker <span style="color:#ff79c6">=</span> createMarker({ map, position<span style="color:#ff79c6">:</span> initialPosition });
  <span style="color:#ff79c6">const</span> $info <span style="color:#ff79c6">=</span> <span style="color:#8be9fd;font-style:italic">document</span>.getElementById(<span style="color:#f1fa8c">&#39;info&#39;</span>);

  trackLocation({
    onSuccess<span style="color:#ff79c6">:</span> ({ coords<span style="color:#ff79c6">:</span> { latitude<span style="color:#ff79c6">:</span> lat, longitude<span style="color:#ff79c6">:</span> lng } }) =&gt; {
      marker.setPosition({ lat, lng });
      map.panTo({ lat, lng });
      <span style="color:#6272a4">// Print out the user&#39;s location.
</span><span style="color:#6272a4"></span>      $info.textContent <span style="color:#ff79c6">=</span> <span style="color:#f1fa8c">`Lat: </span><span style="color:#f1fa8c">${</span>lat<span style="color:#f1fa8c">}</span><span style="color:#f1fa8c"> Lng: </span><span style="color:#f1fa8c">${</span>lng<span style="color:#f1fa8c">}</span><span style="color:#f1fa8c">`</span>;
      <span style="color:#6272a4">// Don&#39;t forget to remove any error class name.
</span><span style="color:#6272a4"></span>      $info.classList.remove(<span style="color:#f1fa8c">&#39;error&#39;</span>);
    },
    onError<span style="color:#ff79c6">:</span> err =&gt; {
      <span style="color:#6272a4">// Print out the error message.
</span><span style="color:#6272a4"></span>      $info.textContent <span style="color:#ff79c6">=</span> <span style="color:#f1fa8c">`Error: </span><span style="color:#f1fa8c">${</span>getPositionErrorMessage(err.code) <span style="color:#ff79c6">||</span> err.message<span style="color:#f1fa8c">}</span><span style="color:#f1fa8c">`</span>;
      <span style="color:#6272a4">// Add error class name.
</span><span style="color:#6272a4"></span>      $info.classList.add(<span style="color:#f1fa8c">&#39;error&#39;</span>);
    }
  });
}
</code></pre></div><p>Now we should get a nice user&rsquo;s coordinate and error at the bottom of the map.</p>
<p><figure>
    <a href="07-geolocation-example.gif"><img src="/code/track-user-location-google-maps/07-geolocation-example.gif" alt="Google Maps Geolocation Example">
    </a><figcaption>Google Maps Geolocation Example</figcaption></figure>
</p>
<p>You can check out the <a href="https://google-maps-geolocation.bitballoon.com/">live demo</a> and play around with it. You can also get the source for this tutorial on Github: <a href="https://github.com/risan/google-maps-geolocation-example">google-maps-geolocation-example</a>.</p>
<p>Credits:</p>
<ul>
<li>Globe by <a href="https://unsplash.com/@nicolegeri">Nicole Harrington</a> on <a href="https://unsplash.com/photos/eUyNYtwN0tA">Unsplash</a>.</li>
</ul>
<footer>
        <ul>
            <li>
                <span>Categories:&nbsp;</span><a href="/categories/tutorial/">tutorial</a></li>
            <li>
                <span>Tags:&nbsp;</span><a href="/tags/javascript/">javascript</a>,&nbsp;<a href="/tags/maps/">maps</a></li><li><span>Next:&nbsp;</span><a href="/code/seeding-table-with-relationships-in-laravel/">Seeding Table with Relationships in Laravel</a></li><li><span>Previous:&nbsp;</span><a href="/code/installing-sql-server-on-macos/">Installing SQL Server on macOS</a></li></ul>
    </footer></article>
</main>
<footer>
    <small>&copy; Rachel Ombok 2021</small>
    <nav>
        <small><a href="https://github.com/rachelombok">Github</a>
        <a href="https://twitter.com/therachelplan">Twitter</a>
        <a href="https://rachelombok.com/">Main</a></small>
    </nav>
</footer></body>
</html>