<!DOCTYPE html>
<html lang='en-us'>
<head>
    <meta charset="utf-8">
    <title>Python Notes from Intro to Machine Learning | rachel&#39;s blog</title>
    <meta name="description" content="I rarely use Python. I only have one repository at Github that is written in Python: iris-flower-classifier. And it was written two years ago!
A few days ago I took this free course from Udacity: ‚Ä¶">
    <meta name="viewport" content="width=device-width, initial-scale=1"><meta property="og:title" content="Python Notes from Intro to Machine Learning" />
<meta property="og:description" content="I rarely use Python. I only have one repository at Github that is written in Python: iris-flower-classifier. And it was written two years ago!
A few days ago I took this free course from Udacity: Intro to Machine Learning. The machine learning related codes are quite easy to grasp since it simply uses the scikit-learn modules. But most of the supporting Python modules that are provided by this course were like a black-box to me." />
<meta property="og:type" content="article" />
<meta property="og:url" content="/code/python-notes-from-intro-to-machine-learning/" /><meta property="og:image" content="/img/python.png" /><meta property="article:section" content="code" />
<meta property="article:published_time" content="2018-04-14T10:00:00&#43;02:00" />
<meta property="article:modified_time" content="2018-04-14T10:00:00&#43;02:00" /><meta property="og:site_name" content="Software Engineering" />

<meta name="twitter:card" content="summary_large_image"/>
<meta name="twitter:image" content="/img/python.png"/>

<meta name="twitter:title" content="Python Notes from Intro to Machine Learning"/>
<meta name="twitter:description" content="I rarely use Python. I only have one repository at Github that is written in Python: iris-flower-classifier. And it was written two years ago!
A few days ago I took this free course from Udacity: Intro to Machine Learning. The machine learning related codes are quite easy to grasp since it simply uses the scikit-learn modules. But most of the supporting Python modules that are provided by this course were like a black-box to me."/>
<link rel="sitemap" type="application/xml" href="/sitemap.xml">
    <link rel="stylesheet" href="/styles.min.9606769ff64b7bcb06eaeff008d91ef001a5fffd74383d9b698531628b2f525e.css">
    <link rel=icon href='data:image/svg+xml,<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 100 100"><text y=".9em" font-size="90">üç£</text></svg>'></head>
<body>
<header>
    <a href="/" class='blog-title'>
       
        <h1>blog.</h1>
    </a>
    <nav>
        <a href="/categories/">Categories</a>
        
        <a href="/about/">About</a>
    </nav>
</header>
<main>
<article>
    <h1 class='article-title'>Python Notes from Intro to Machine Learning</h1><time datetime='2018-04-14T10:00:00&#43;02:00'>2018-04-14</time><p>I rarely use Python. I only have one repository at Github that is written in Python: <a href="https://github.com/risan/iris-flower-classifier">iris-flower-classifier</a>. And it was written two years ago!</p>
<p>A few days ago I took this free course from Udacity: <a href="https://eu.udacity.com/course/intro-to-machine-learning--ud120">Intro to Machine Learning</a>. The machine learning related codes are quite easy to grasp since it simply uses the <a href="http://scikit-learn.org/">scikit-learn</a> modules. But most of the supporting Python modules that are provided by this course were like a black-box to me. I had no idea how to download a file in Python or what&rsquo;s the difference between a list, a tuple and a dictionary.</p>
<p>That&rsquo;s why I decided to read all of the provided Python modules and implement it myself. I ended up refactor most of the code so it&rsquo;s easier to understand: <a href="https://github.com/risan/intro-to-machine-learning">github.com/risan/intro-to-machine-learning</a>.</p>
<p>So here are some notes and snippets of Python that I&rsquo;ve been collecting so far (I&rsquo;m not even halfway through the course üòù). Also, note that the codes here are still using Python version 2.7.</p>
<h2>Table of Contents</h2>
<nav id="TableOfContents">
  <ul>
    <li><a href="#modules-classes-and-functions">Modules Classes and Functions</a>
      <ul>
        <li><a href="#main-entry-file">Main Entry File</a></li>
        <li><a href="#import-python-module-dynamically">Import Python Module Dynamically</a></li>
        <li><a href="#multiple-returns-in-python">Multiple Returns in Python</a></li>
        <li><a href="#importing-modules-outside-of-the-directory">Importing Modules Outside of the Directory</a></li>
      </ul>
    </li>
    <li><a href="#output">Output</a>
      <ul>
        <li><a href="#print-the-emojis">Print The Emojis</a></li>
        <li><a href="#pretty-print">Pretty Print</a></li>
      </ul>
    </li>
    <li><a href="#working-with-pathname">Working with Pathname</a>
      <ul>
        <li><a href="#get-filename-from-url">Get Filename From URL</a></li>
        <li><a href="#check-if-file-exists">Check if File Exists</a></li>
        <li><a href="#create-a-directory-if-it-does-not-exists">Create a Directory if It Does Not Exists</a></li>
      </ul>
    </li>
    <li><a href="#working-with-files">Working with Files</a>
      <ul>
        <li><a href="#downloading-a-file">Downloading a File</a></li>
        <li><a href="#extracting-tar-file">Extracting Tar File</a></li>
      </ul>
    </li>
    <li><a href="#working-with-list">Working with List</a>
      <ul>
        <li><a href="#generate-a-list-of-random-numbers">Generate a List of Random Numbers</a></li>
        <li><a href="#pair-values-from-two-lists">Pair Values from Two Lists</a></li>
        <li><a href="#splitting-a-list">Splitting a List</a></li>
        <li><a href="#filtering-a-list-in-one-line">Filtering a List In One Line</a></li>
        <li><a href="#sorting-a-list-in-ascending-order">Sorting a List in Ascending Order</a></li>
        <li><a href="#using-filter-function-with-a-list">Using Filter Function with a List</a></li>
        <li><a href="#using-reduce-with-a-list-of-dictionary">Using Reduce with a List of Dictionary</a></li>
      </ul>
    </li>
    <li><a href="#working-with-dictionary">Working with Dictionary</a>
      <ul>
        <li><a href="#loop-through-dictionary">Loop Through Dictionary</a></li>
        <li><a href="#calculate-total-of-particular-dictionary-key">Calculate Total of Particular Dictionary Key</a></li>
      </ul>
    </li>
    <li><a href="#working-with-numpy">Working with Numpy</a>
      <ul>
        <li><a href="#numpy-create-range-of-values-with-the-given-interval">Numpy Create Range of Values with The Given Interval</a></li>
        <li><a href="#numpy-create-coordinate-matrices-from-coordinate-vectors">Numpy Create Coordinate Matrices from Coordinate Vectors</a></li>
        <li><a href="#flatten-numpy-array">Flatten Numpy Array</a></li>
        <li><a href="#pairing-array-values-with-second-axis">Pairing Array Values with Second Axis</a></li>
        <li><a href="#generate-coordinates-across-the-grid">Generate Coordinates Across The Grid</a></li>
      </ul>
    </li>
    <li><a href="#plotting-the-data">Plotting the Data</a>
      <ul>
        <li><a href="#plot-the-surface-decision">Plot The Surface Decision</a></li>
        <li><a href="#scatter-plot">Scatter Plot</a></li>
      </ul>
    </li>
    <li><a href="#dealing-with-data">Dealing with Data</a>
      <ul>
        <li><a href="#deserializing-python-object">Deserializing Python Object</a></li>
        <li><a href="#split-data-for-training-and-testing">Split Data for Training and Testing</a></li>
        <li><a href="#vectorized-the-strings">Vectorized the Strings</a></li>
        <li><a href="#feature-selection">Feature Selection</a></li>
      </ul>
    </li>
  </ul>
</nav>

<h2 id="modules-classes-and-functions">Modules Classes and Functions</h2>
<h3 id="main-entry-file">Main Entry File</h3>
<p>Suppose our Python project is stored in <code>/foo/bar</code> directory. And this application has one file that serves as the single entry point. We can name this file <code>__main__.py</code> so we can run this project simply be referencing its directory path:</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-bash" data-lang="bash"><span style="color:#6272a4"># Referencing its directory.</span>
$ python /foo/bar

<span style="color:#6272a4"># It&#39;s equivalent to this.</span>
$ python /foo/bar/__main__.py
</code></pre></div><h3 id="import-python-module-dynamically">Import Python Module Dynamically</h3>
<p>Suppose we would like to import a Python module dynamically based on a variable value. We can achieve this through the <a href="https://docs.python.org/2/library/functions.html#__import__"><code>__import__</code></a> function:</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-py" data-lang="py">module_name <span style="color:#ff79c6">=</span> <span style="color:#f1fa8c">&#34;numpy&#34;</span>

<span style="color:#8be9fd;font-style:italic">__import__</span>(module_name)
</code></pre></div><h3 id="multiple-returns-in-python">Multiple Returns in Python</h3>
<p>In Python, it&rsquo;s possible for a function or a method to return multiple values. We can do this simply by separating each return value by a comma:</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-py" data-lang="py"><span style="color:#ff79c6">def</span> <span style="color:#50fa7b">test</span>():
    <span style="color:#ff79c6">return</span> <span style="color:#bd93f9">100</span>, <span style="color:#f1fa8c">&#34;foo&#34;</span>

someNumber, someString <span style="color:#ff79c6">=</span> test()
</code></pre></div><h3 id="importing-modules-outside-of-the-directory">Importing Modules Outside of the Directory</h3>
<p>In order to import a module from outside of the directory, we need to add that module&rsquo;s directory path into the current file with <code>sys.path.append</code>. Suppose we have the following directory structure:</p>
<pre><code>|--foo
| |-- bar.py
|
|-- tools
| |-- speak_yoda.py
</code></pre><p>If we want to use the <code>speak_yoda.py</code> module within the <code>bar.py</code>, we can do the following:</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-py" data-lang="py"><span style="color:#6272a4"># /foo/bar.py</span>
<span style="color:#ff79c6">import</span> os

<span style="color:#6272a4"># Use relative path to tools directory.</span>
sys<span style="color:#ff79c6">.</span>path<span style="color:#ff79c6">.</span>append(<span style="color:#f1fa8c">&#34;../tools&#34;</span>)

<span style="color:#ff79c6">import</span> speak_yoda
</code></pre></div><p>However, this won&rsquo;t work if we run the <code>baz.py</code> file from outside of its <code>foo</code> directory:</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-bash" data-lang="bash"><span style="color:#6272a4"># It works inside of the /foo directory.</span>
$ <span style="color:#8be9fd;font-style:italic">cd</span> /foo
$ python bar.py

<span style="color:#6272a4"># But it won&#39;t work if the code runs from outside of /foo directory.</span>
$ python foo/bar.py
</code></pre></div><p>To solve this problem we can refer to the <code>tools</code> directory using its absolute path.</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-py" data-lang="py"><span style="color:#6272a4"># /foo/bar.py</span>
<span style="color:#ff79c6">import</span> os
<span style="color:#ff79c6">import</span> sys

<span style="color:#6272a4"># Get the directory name for this file.</span>
current_dirname <span style="color:#ff79c6">=</span> os<span style="color:#ff79c6">.</span>path<span style="color:#ff79c6">.</span>dirname(os<span style="color:#ff79c6">.</span>path<span style="color:#ff79c6">.</span>realpath(__file__))

<span style="color:#6272a4"># Use the absolute path to the tools directory</span>
tools_path <span style="color:#ff79c6">=</span> os<span style="color:#ff79c6">.</span>path<span style="color:#ff79c6">.</span>abspath(os<span style="color:#ff79c6">.</span>path<span style="color:#ff79c6">.</span>join(dirname, <span style="color:#f1fa8c">&#34;../tools&#34;</span>))
sys<span style="color:#ff79c6">.</span>path<span style="color:#ff79c6">.</span>append(tools_path)

<span style="color:#ff79c6">import</span> speak_yoda
</code></pre></div><h2 id="output">Output</h2>
<h3 id="print-the-emojis">Print The Emojis</h3>
<p>It turns out you can&rsquo;t just print an emoji or any other Unicode characters to the console. You need to specify the encoding type beforehand:</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-py" data-lang="py"><span style="color:#6272a4"># coding: utf8</span>

<span style="color:#ff79c6">print</span>(<span style="color:#f1fa8c">&#34;üòÖ&#34;</span>)
</code></pre></div><h3 id="pretty-print">Pretty Print</h3>
<p>We can use the <code>pprint</code> module to pretty-print Python data structure with a configurable indentation:</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-py" data-lang="py"><span style="color:#ff79c6">import</span> pprint
pp <span style="color:#ff79c6">=</span> pprint<span style="color:#ff79c6">.</span>PrettyPrinter(indent<span style="color:#ff79c6">=</span><span style="color:#bd93f9">2</span>)

pp<span style="color:#ff79c6">.</span>pprint(people)
</code></pre></div><h2 id="working-with-pathname">Working with Pathname</h2>
<p>Read more about pathname manipulations in the <a href="https://docs.python.org/2/library/os.path.html"><code>os.path</code> documentation</a>.</p>
<h3 id="get-filename-from-url">Get Filename From URL</h3>
<p>Suppose the last segment of the URL contains a filename that we would like to download. We can extract this filename with the following code:</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-py" data-lang="py"><span style="color:#ff79c6">import</span> os
<span style="color:#ff79c6">from</span> urlparse <span style="color:#ff79c6">import</span> urlparse

url <span style="color:#ff79c6">=</span> <span style="color:#f1fa8c">&#34;https://example.com/foo.txt&#34;</span>

url_components <span style="color:#ff79c6">=</span> urlparse(url)

filename <span style="color:#ff79c6">=</span> os<span style="color:#ff79c6">.</span>path<span style="color:#ff79c6">.</span>basename(url_components<span style="color:#ff79c6">.</span>path) <span style="color:#6272a4"># foo.txt</span>
</code></pre></div><h3 id="check-if-file-exists">Check if File Exists</h3>
<p>To check whether the given file path exists or not:</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-py" data-lang="py"><span style="color:#ff79c6">import</span> os

is_exists <span style="color:#ff79c6">=</span> os<span style="color:#ff79c6">.</span>path<span style="color:#ff79c6">.</span>isfile(<span style="color:#f1fa8c">&#34;foo.txt&#34;</span>)
</code></pre></div><h3 id="create-a-directory-if-it-does-not-exists">Create a Directory if It Does Not Exists</h3>
<p>To create a directory only if it does not exist:</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-py" data-lang="py"><span style="color:#ff79c6">import</span> os
<span style="color:#ff79c6">import</span> errno

<span style="color:#ff79c6">try</span>:
    os<span style="color:#ff79c6">.</span>makedirs(directory_path)
<span style="color:#ff79c6">except</span> OSError, e:
    <span style="color:#ff79c6">if</span> e<span style="color:#ff79c6">.</span>errno <span style="color:#ff79c6">!=</span> errno<span style="color:#ff79c6">.</span>EEXIST:
        <span style="color:#ff79c6">raise</span>
</code></pre></div><h2 id="working-with-files">Working with Files</h2>
<h3 id="downloading-a-file">Downloading a File</h3>
<p>We can use the <code>urllib</code> module to download a file in Python. The first argument is the file URL that we would like to download. The second argument is the optional filename that will be used to store the file.</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-py" data-lang="py"><span style="color:#ff79c6">import</span> urllib

urllib<span style="color:#ff79c6">.</span>urlretrieve(<span style="color:#f1fa8c">&#34;https://example.com/foo.txt&#34;</span>, <span style="color:#f1fa8c">&#34;foo.txt&#34;</span>)
</code></pre></div><h3 id="extracting-tar-file">Extracting Tar File</h3>
<p>There&rsquo;s a built-in <code>tarfile</code> module that we can use to work with Tar file in Python. To extract the <code>tar.gz</code> file we can use the following code:</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-py" data-lang="py"><span style="color:#ff79c6">import</span> tarfile

<span style="color:#6272a4"># Open the file.</span>
tfile <span style="color:#ff79c6">=</span> tarfile<span style="color:#ff79c6">.</span>open(<span style="color:#f1fa8c">&#34;foo.tar.gz&#34;</span>)

<span style="color:#6272a4"># Extract the file to the given path.</span>
tfile<span style="color:#ff79c6">.</span>extractall(path)
</code></pre></div><p>We can pass the <code>mode</code> argument to the <code>open</code> method. By default, the <code>mode</code> would be <code>r</code>‚Äîreading mode with transparent compression. There are also other mode options that we can use:</p>
<ul>
<li><code>r:gz</code>: Reading mode with gzip compression.</li>
<li><code>r:</code>: Reading mode without compression.</li>
<li><code>a</code>: Appending mode without compression.</li>
<li><code>w</code>: Writting mode without compression.</li>
<li>Checkout other available options in <a href="https://docs.python.org/2/library/tarfile.html">tarfile documentation</a>.</li>
</ul>
<h2 id="working-with-list">Working with List</h2>
<h3 id="generate-a-list-of-random-numbers">Generate a List of Random Numbers</h3>
<p>Use the <code>for..in</code> syntax to generate a list of random numbers in a one-liner style.</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-py" data-lang="py"><span style="color:#ff79c6">import</span> random

<span style="color:#6272a4"># Initialize internal state of random generator.</span>
random<span style="color:#ff79c6">.</span>seed(<span style="color:#bd93f9">42</span>)

<span style="color:#6272a4"># Generate random points.</span>
randomNumbers <span style="color:#ff79c6">=</span> [random<span style="color:#ff79c6">.</span>random() <span style="color:#ff79c6">for</span> i <span style="color:#ff79c6">in</span> <span style="color:#8be9fd;font-style:italic">range</span>(<span style="color:#bd93f9">0</span>, <span style="color:#bd93f9">10</span>)]
<span style="color:#6272a4"># [0.6394267984578837, 0.025010755222666936, 0.27502931836911926, ...]</span>
</code></pre></div><h3 id="pair-values-from-two-lists">Pair Values from Two Lists</h3>
<p>The built-in <code>zip</code> function can pair values from two lists. However, this <code>zip</code> function will return a list of tuples instead. To get a list of value pairs, we can combine it with <code>for..in</code> syntax:</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-py" data-lang="py">coordinates <span style="color:#ff79c6">=</span> [[x, y] <span style="color:#ff79c6">for</span> x,y <span style="color:#ff79c6">in</span> <span style="color:#8be9fd;font-style:italic">zip</span>([<span style="color:#bd93f9">5</span>,<span style="color:#bd93f9">10</span>,<span style="color:#bd93f9">15</span>], [<span style="color:#bd93f9">0</span>,<span style="color:#bd93f9">1</span>,<span style="color:#bd93f9">0</span>])]
<span style="color:#6272a4"># [[5, 0], [10, 1], [15, 0]]</span>
</code></pre></div><h3 id="splitting-a-list">Splitting a List</h3>
<p>We can easily split a list in Python by specifying the starting index and it&rsquo;s ending index. Note that the ending index is excluded from the result.</p>
<p>We can also specify a negative index. And also note that both of these indices are optional!</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-py" data-lang="py">a <span style="color:#ff79c6">=</span> [<span style="color:#bd93f9">0</span>,<span style="color:#bd93f9">1</span>,<span style="color:#bd93f9">2</span>,<span style="color:#bd93f9">3</span>,<span style="color:#bd93f9">4</span>,<span style="color:#bd93f9">5</span>]

a[<span style="color:#bd93f9">0</span>:<span style="color:#bd93f9">3</span>]  <span style="color:#6272a4"># 0,1,2</span>
a[<span style="color:#bd93f9">1</span>:<span style="color:#bd93f9">3</span>]  <span style="color:#6272a4"># 1,2</span>
a[<span style="color:#bd93f9">2</span>:]   <span style="color:#6272a4"># 2,3,4,5</span>
a[:<span style="color:#bd93f9">3</span>]   <span style="color:#6272a4"># 0,1,2</span>
a[<span style="color:#bd93f9">0</span>:<span style="color:#ff79c6">-</span><span style="color:#bd93f9">2</span>] <span style="color:#6272a4"># 0,1,2,3</span>
a[<span style="color:#ff79c6">-</span><span style="color:#bd93f9">2</span>:]  <span style="color:#6272a4"># 4,5</span>
a[:]    <span style="color:#6272a4"># 0,1,2,3,4,5</span>
</code></pre></div><h3 id="filtering-a-list-in-one-line">Filtering a List In One Line</h3>
<p>We can easily filter a list in Python by combining the <code>for..in</code> and the <code>if</code> syntax together:</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-py" data-lang="py">numbers <span style="color:#ff79c6">=</span> <span style="color:#8be9fd;font-style:italic">range</span>(<span style="color:#bd93f9">1</span>,<span style="color:#bd93f9">11</span>)

<span style="color:#6272a4"># Filter even numbers only.</span>
[numbers[i] <span style="color:#ff79c6">for</span> i <span style="color:#ff79c6">in</span> <span style="color:#8be9fd;font-style:italic">range</span>(<span style="color:#bd93f9">0</span>, <span style="color:#8be9fd;font-style:italic">len</span>(numbers)) <span style="color:#ff79c6">if</span> numbers[i] <span style="color:#ff79c6">%</span> <span style="color:#bd93f9">2</span> <span style="color:#ff79c6">==</span> <span style="color:#bd93f9">0</span>]
<span style="color:#6272a4"># [2, 4, 6, 8, 10]</span>
</code></pre></div><h3 id="sorting-a-list-in-ascending-order">Sorting a List in Ascending Order</h3>
<p>In Python, we can sort a list in ascending order simply by calling the <code>sort</code> method like so:</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-py" data-lang="py">people <span style="color:#ff79c6">=</span> [<span style="color:#f1fa8c">&#34;John&#34;</span>, <span style="color:#f1fa8c">&#34;Alice&#34;</span>, <span style="color:#f1fa8c">&#34;Poe&#34;</span>]
people<span style="color:#ff79c6">.</span>sort()
<span style="color:#ff79c6">print</span>(people) <span style="color:#6272a4"># [&#34;Alice&#34;, &#34;John&#34;, &#34;Poe&#34;]</span>
</code></pre></div><h3 id="using-filter-function-with-a-list">Using Filter Function with a List</h3>
<p>Just like its name, we can use the <code>filter</code> function to filter out our list:</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-py" data-lang="py">numbers <span style="color:#ff79c6">=</span> <span style="color:#8be9fd;font-style:italic">range</span>(<span style="color:#bd93f9">1</span>, <span style="color:#bd93f9">11</span>)

even_numbers <span style="color:#ff79c6">=</span> <span style="color:#8be9fd;font-style:italic">filter</span>(<span style="color:#ff79c6">lambda</span> number: number <span style="color:#ff79c6">%</span> <span style="color:#bd93f9">2</span> <span style="color:#ff79c6">==</span> <span style="color:#bd93f9">0</span>, numbers)
<span style="color:#6272a4"># [2, 4, 6, 8, 10]</span>
</code></pre></div><p>We can break the above statement into two parts:</p>
<ul>
<li><code>lambda number: statement</code>: The first part is the function that we would like to run to every item on the list. <code>number</code> is the variable name we&rsquo;d like to use in this function to refer to a single item from the <code>numbers</code> list. The following function body must evaluate to truthy/falsy value‚Äîfalsy means the current item will be removed from the final result.</li>
<li><code>numbers</code>: The second parameter is the list that we&rsquo;d like to filter.</li>
</ul>
<h3 id="using-reduce-with-a-list-of-dictionary">Using Reduce with a List of Dictionary</h3>
<p>We can use the <code>reduce</code> function to calculate the total of a particular key in a list of a dictionary:</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-py" data-lang="py">items <span style="color:#ff79c6">=</span> [{value:<span style="color:#bd93f9">10</span>}, {value:<span style="color:#bd93f9">20</span>}, {value:<span style="color:#bd93f9">50</span>}]

<span style="color:#6272a4"># Calculate the total of value key.</span>
totalValues <span style="color:#ff79c6">=</span> <span style="color:#8be9fd;font-style:italic">reduce</span>(<span style="color:#ff79c6">lambda</span> total, item: total <span style="color:#ff79c6">+</span> item[<span style="color:#f1fa8c">&#34;value&#34;</span>], items, <span style="color:#bd93f9">0</span>) <span style="color:#6272a4"># 80</span>
</code></pre></div><p>It can be broken down into 4 parts:</p>
<ul>
<li><code>lambda total</code>: It&rsquo;s the variable name that we&rsquo;d like to use in the function body to refer to the carried or the accumulative value that will finally be returned.</li>
<li><code>item: statement</code>: <code>item</code> is the name of the variable we&rsquo;d like to use within the function body to refer to the single item in the <code>items</code> list. The following function body will be executed in order to define the accumulative value of <code>total</code> for the next iteration.</li>
<li><code>items</code>: It&rsquo;s the list of item that we would like to &ldquo;reduce&rdquo;.</li>
<li><code>0</code>: The last parameter is optional and it&rsquo;s the initial accumulative value for the first iteration.</li>
</ul>
<p>We can also use this <code>reduce</code> function to find a single item from the list. Here&rsquo;s an example of code to find the person with the biggest <code>total_payments</code> within the given list of <code>people</code> dictionary.</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-py" data-lang="py">people <span style="color:#ff79c6">=</span> [
    {<span style="color:#f1fa8c">&#34;name&#34;</span>: <span style="color:#f1fa8c">&#34;John&#34;</span>, <span style="color:#f1fa8c">&#34;total_payments&#34;</span>: <span style="color:#bd93f9">100</span>},
    {<span style="color:#f1fa8c">&#34;name&#34;</span>: <span style="color:#f1fa8c">&#34;Alice&#34;</span>, <span style="color:#f1fa8c">&#34;total_payments&#34;</span>: <span style="color:#bd93f9">1000</span>},
    {<span style="color:#f1fa8c">&#34;name&#34;</span>: <span style="color:#f1fa8c">&#34;Poe&#34;</span>, <span style="color:#f1fa8c">&#34;total_payments&#34;</span>: <span style="color:#bd93f9">800</span>}
]

person_biggest_total_payments <span style="color:#ff79c6">=</span> <span style="color:#8be9fd;font-style:italic">reduce</span>(<span style="color:#ff79c6">lambda</span> paid_most, person: person <span style="color:#ff79c6">if</span> person[<span style="color:#f1fa8c">&#34;total_payments&#34;</span>] <span style="color:#ff79c6">&gt;</span> paid_most[<span style="color:#f1fa8c">&#34;total_payments&#34;</span>] <span style="color:#ff79c6">else</span> paid_most, people, { <span style="color:#f1fa8c">&#34;total_payments&#34;</span>: <span style="color:#bd93f9">0</span> })
<span style="color:#6272a4"># {&#39;name&#39;: &#39;Alice&#39;, &#39;total_payments&#39;: 1000}</span>
</code></pre></div><h2 id="working-with-dictionary">Working with Dictionary</h2>
<h3 id="loop-through-dictionary">Loop Through Dictionary</h3>
<p>We can use the <code>itervalues</code> method to loop through a dictionary:</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-py" data-lang="py"><span style="color:#ff79c6">for</span> person <span style="color:#ff79c6">in</span> people<span style="color:#ff79c6">.</span>itervalues():
    <span style="color:#ff79c6">print</span>(person[<span style="color:#f1fa8c">&#34;email_address&#34;</span>])
</code></pre></div><p>We can also use the <code>iteritems</code> method if we want to access the key too:</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-py" data-lang="py"><span style="color:#ff79c6">for</span> person <span style="color:#ff79c6">in</span> people<span style="color:#ff79c6">.</span>iteritems():
    <span style="color:#ff79c6">print</span>(person[<span style="color:#bd93f9">0</span>] <span style="color:#ff79c6">+</span> <span style="color:#f1fa8c">&#34;: &#34;</span> <span style="color:#ff79c6">+</span> person[<span style="color:#bd93f9">1</span>][<span style="color:#f1fa8c">&#34;email_address&#34;</span>])
</code></pre></div><h3 id="calculate-total-of-particular-dictionary-key">Calculate Total of Particular Dictionary Key</h3>
<p>Suppose we would like to calculate the total amount of <code>salary</code> key on a <code>people</code> dictionary. We can extract the <code>salary</code> key and use the <code>sum</code> function to get the total:</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-py" data-lang="py">total_salary <span style="color:#ff79c6">=</span> <span style="color:#8be9fd;font-style:italic">sum</span>([person[<span style="color:#f1fa8c">&#34;salary&#34;</span>] <span style="color:#ff79c6">for</span> person <span style="color:#ff79c6">in</span> people<span style="color:#ff79c6">.</span>itervalues()])
</code></pre></div><h2 id="working-with-numpy">Working with Numpy</h2>
<h3 id="numpy-create-range-of-values-with-the-given-interval">Numpy Create Range of Values with The Given Interval</h3>
<p>Use the <a href="https://docs.scipy.org/doc/numpy/reference/generated/numpy.arange.html"><code>arange</code></a> method to create an array with an evenly spaced interval.</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-py" data-lang="py"><span style="color:#ff79c6">import</span> numpy <span style="color:#ff79c6">as</span> np

np<span style="color:#ff79c6">.</span>arange(<span style="color:#bd93f9">0</span>, <span style="color:#bd93f9">5</span>, <span style="color:#bd93f9">1</span>)
<span style="color:#6272a4"># array([0,1,2,3,4])</span>

np<span style="color:#ff79c6">.</span>arange(<span style="color:#bd93f9">1</span>, <span style="color:#bd93f9">4</span>, <span style="color:#bd93f9">0.5</span>)
<span style="color:#6272a4"># array([1. , 1.5, 2. , 2.5, 3. , 3.5])</span>
</code></pre></div><h3 id="numpy-create-coordinate-matrices-from-coordinate-vectors">Numpy Create Coordinate Matrices from Coordinate Vectors</h3>
<p>We can use the Numpy <a href="https://docs.scipy.org/doc/numpy/reference/generated/numpy.meshgrid.html"><code>meshgrid</code></a> method to make coordinate matrices from one-dimentional coordinate arrays.</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-py" data-lang="py"><span style="color:#ff79c6">import</span> numpy <span style="color:#ff79c6">as</span> np

np<span style="color:#ff79c6">.</span>meshgrid([<span style="color:#bd93f9">1</span>, <span style="color:#bd93f9">2</span>, <span style="color:#bd93f9">3</span>], [<span style="color:#bd93f9">0</span>, <span style="color:#bd93f9">7</span>])
<span style="color:#6272a4"># [</span>
<span style="color:#6272a4">#   array([[1,2,3], [1,2,3]]),</span>
<span style="color:#6272a4">#   array([[0,0,0], [7,7,7]])</span>
<span style="color:#6272a4"># ]</span>
</code></pre></div><h3 id="flatten-numpy-array">Flatten Numpy Array</h3>
<p>When we have a multi-dimensional Numpy array, we can easily flatten it with the <a href="https://docs.scipy.org/doc/numpy/reference/generated/numpy.ravel.html"><code>ravel</code></a> method:</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-py" data-lang="py"><span style="color:#ff79c6">import</span> numpy <span style="color:#ff79c6">as</span> np

arr <span style="color:#ff79c6">=</span> np<span style="color:#ff79c6">.</span>array([[<span style="color:#bd93f9">1</span>,<span style="color:#bd93f9">2</span>], [<span style="color:#bd93f9">3</span>,<span style="color:#bd93f9">4</span>]])
arr<span style="color:#ff79c6">.</span>ravel()
<span style="color:#6272a4"># array([1, 2, 3, 4])</span>
</code></pre></div><h3 id="pairing-array-values-with-second-axis">Pairing Array Values with Second Axis</h3>
<p>We can use Numpy <code>c_</code> function to pair array values with another array that will be it&rsquo;s second axis. Read the <a href="https://docs.scipy.org/doc/numpy/reference/generated/numpy.c_.html"><code>numpy.c_</code> documentation</a>.</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-py" data-lang="py"><span style="color:#ff79c6">import</span> numpy <span style="color:#ff79c6">as</span> np

x <span style="color:#ff79c6">=</span> [<span style="color:#bd93f9">1</span>,<span style="color:#bd93f9">2</span>]
y <span style="color:#ff79c6">=</span> [<span style="color:#bd93f9">10</span>,<span style="color:#bd93f9">20</span>]

np<span style="color:#ff79c6">.</span>c_[x, y]
<span style="color:#6272a4"># array([1,10], [2,20])</span>
</code></pre></div><h3 id="generate-coordinates-across-the-grid">Generate Coordinates Across The Grid</h3>
<p>With the knowledge of Numpy <a href="https://docs.scipy.org/doc/numpy/reference/generated/numpy.arange.html"><code>arange</code></a>, <a href="https://docs.scipy.org/doc/numpy/reference/generated/numpy.meshgrid.html"><code>meshgrid</code></a>, <a href="https://docs.scipy.org/doc/numpy/reference/generated/numpy.ravel.html"><code>ravel</code></a> and <a href="https://docs.scipy.org/doc/numpy/reference/generated/numpy.c_.html"><code>c_</code></a> methods, we can easily generate an evenly spaced coordinates across the grid so we can pass it to the classifier and plot the decision surface.</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-py" data-lang="py"><span style="color:#ff79c6">import</span> numpy <span style="color:#ff79c6">as</span> np

<span style="color:#6272a4"># Generate an evenly spaced coordinates.</span>
x_points, y_points <span style="color:#ff79c6">=</span> np<span style="color:#ff79c6">.</span>meshgrid(np<span style="color:#ff79c6">.</span>arange(x_min, x_max, step), np<span style="color:#ff79c6">.</span>arange(y_min, y_max, step))

<span style="color:#6272a4"># Pair the x and y points.</span>
test_coordinates <span style="color:#ff79c6">=</span> np<span style="color:#ff79c6">.</span>c_[x_points<span style="color:#ff79c6">.</span>ravel(), y_points<span style="color:#ff79c6">.</span>ravel()]
</code></pre></div><h2 id="plotting-the-data">Plotting the Data</h2>
<h3 id="plot-the-surface-decision">Plot The Surface Decision</h3>
<p>We can pass an evenly spaced coordinates across the grid to the classifier to predict the output on each of that coordinate. We can then use <a href="https://matplotlib.org/api/pyplot_api.html"><code>matplotlib.pyplot</code></a> to plot the surface decision.</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-py" data-lang="py"><span style="color:#ff79c6">import</span> matplotlib.pyplot <span style="color:#ff79c6">as</span> plt
<span style="color:#ff79c6">import</span> pylab <span style="color:#ff79c6">as</span> pl

<span style="color:#6272a4"># Pass coordinates across the grid.</span>
predicted_labels <span style="color:#ff79c6">=</span> classifier<span style="color:#ff79c6">.</span>predict(test_coordinates)

<span style="color:#6272a4"># Don&#39;t forget to reshape the output array dimension.</span>
predicted_labels <span style="color:#ff79c6">=</span> predicted_labels<span style="color:#ff79c6">.</span>reshape(x_points<span style="color:#ff79c6">.</span>shape)

<span style="color:#6272a4"># Set the axes limit.</span>
plt<span style="color:#ff79c6">.</span>xlim(x_points<span style="color:#ff79c6">.</span>min(), x_points<span style="color:#ff79c6">.</span>max())
plt<span style="color:#ff79c6">.</span>ylim(y_points<span style="color:#ff79c6">.</span>min(), y_points<span style="color:#ff79c6">.</span>max())

<span style="color:#6272a4"># Plot the decision boundary with seismic color map.</span>
plt<span style="color:#ff79c6">.</span>pcolormesh(x_points, y_points, predicted_labels, cmap <span style="color:#ff79c6">=</span> pl<span style="color:#ff79c6">.</span>cm<span style="color:#ff79c6">.</span>seismic)
</code></pre></div><p>The classifier output would be a one-dimensional array, so don&rsquo;t forget to <a href="https://docs.scipy.org/doc/numpy/reference/generated/numpy.reshape.html"><code>reshape</code></a> it back into a two-dimensional array before plotting. The <code>cmap</code> is an optional parameter for the color map. Here we use the <code>seismic</code> color map from <code>pylab</code> module. It has the red-blue colors.</p>
<h3 id="scatter-plot">Scatter Plot</h3>
<p>We need to separate the test points based on its predicted label (the speed). So we can plot the test points with two different colors.</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-py" data-lang="py"><span style="color:#6272a4"># Separate fast (label = 0) &amp; slow (label = 1) test points.</span>
grade_fast <span style="color:#ff79c6">=</span> [features_test[i][<span style="color:#bd93f9">0</span>] <span style="color:#ff79c6">for</span> i <span style="color:#ff79c6">in</span> <span style="color:#8be9fd;font-style:italic">range</span>(<span style="color:#bd93f9">0</span>, <span style="color:#8be9fd;font-style:italic">len</span>(features_test)) <span style="color:#ff79c6">if</span> labels_test[i] <span style="color:#ff79c6">==</span> <span style="color:#bd93f9">0</span>]
bumpy_fast <span style="color:#ff79c6">=</span> [features_test[i][<span style="color:#bd93f9">1</span>] <span style="color:#ff79c6">for</span> i <span style="color:#ff79c6">in</span> <span style="color:#8be9fd;font-style:italic">range</span>(<span style="color:#bd93f9">0</span>, <span style="color:#8be9fd;font-style:italic">len</span>(features_test)) <span style="color:#ff79c6">if</span> labels_test[i] <span style="color:#ff79c6">==</span> <span style="color:#bd93f9">0</span>]
grade_slow <span style="color:#ff79c6">=</span> [features_test[i][<span style="color:#bd93f9">0</span>] <span style="color:#ff79c6">for</span> i <span style="color:#ff79c6">in</span> <span style="color:#8be9fd;font-style:italic">range</span>(<span style="color:#bd93f9">0</span>, <span style="color:#8be9fd;font-style:italic">len</span>(features_test)) <span style="color:#ff79c6">if</span> labels_test[i] <span style="color:#ff79c6">==</span> <span style="color:#bd93f9">1</span>]
bumpy_slow <span style="color:#ff79c6">=</span> [features_test[i][<span style="color:#bd93f9">1</span>] <span style="color:#ff79c6">for</span> i <span style="color:#ff79c6">in</span> <span style="color:#8be9fd;font-style:italic">range</span>(<span style="color:#bd93f9">0</span>, <span style="color:#8be9fd;font-style:italic">len</span>(features_test)) <span style="color:#ff79c6">if</span> labels_test[i] <span style="color:#ff79c6">==</span> <span style="color:#bd93f9">1</span>]

<span style="color:#6272a4"># Plot the test points based on its speed.</span>
plt<span style="color:#ff79c6">.</span>scatter(grade_fast, bumpy_fast, color <span style="color:#ff79c6">=</span> <span style="color:#f1fa8c">&#34;b&#34;</span>, label <span style="color:#ff79c6">=</span> <span style="color:#f1fa8c">&#34;fast&#34;</span>)
plt<span style="color:#ff79c6">.</span>scatter(grade_slow, bumpy_slow, color <span style="color:#ff79c6">=</span> <span style="color:#f1fa8c">&#34;r&#34;</span>, label <span style="color:#ff79c6">=</span> <span style="color:#f1fa8c">&#34;slow&#34;</span>)

<span style="color:#6272a4"># Show the plot legend.</span>
plt<span style="color:#ff79c6">.</span>legend()

<span style="color:#6272a4"># Add the axis labels.</span>
plt<span style="color:#ff79c6">.</span>xlabel(<span style="color:#f1fa8c">&#34;grade&#34;</span>)
plt<span style="color:#ff79c6">.</span>ylabel(<span style="color:#f1fa8c">&#34;bumpiness&#34;</span>)

<span style="color:#6272a4"># Show the plot.</span>
plt<span style="color:#ff79c6">.</span>show()
</code></pre></div><p>If we want to save the plot into an image, we can use the <code>savefig</code> method instead:</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-py" data-lang="py">plt<span style="color:#ff79c6">.</span>savefig(<span style="color:#f1fa8c">&#39;scatter_plot.png&#39;</span>)
</code></pre></div><h2 id="dealing-with-data">Dealing with Data</h2>
<h3 id="deserializing-python-object">Deserializing Python Object</h3>
<p>We can use <a href="https://docs.python.org/2/library/pickle.html"><code>pickle</code></a> module for serializing and deserializing Python object. There&rsquo;s also the <code>cPickle</code>‚Äîthe faster C implementation. We use both of these modules to deserialize the email text and author list.</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-py" data-lang="py"><span style="color:#ff79c6">import</span> pickle
<span style="color:#ff79c6">import</span> cPickle

<span style="color:#6272a4"># Unpickling or deserializing the texts.</span>
texts_file_handler <span style="color:#ff79c6">=</span> <span style="color:#8be9fd;font-style:italic">open</span>(texts_file, <span style="color:#f1fa8c">&#34;r&#34;</span>)
texts <span style="color:#ff79c6">=</span> cPickle<span style="color:#ff79c6">.</span>load(texts_file_handler)
texts_file_handler<span style="color:#ff79c6">.</span>close()

<span style="color:#6272a4"># Unpickling or deserializing the authors.</span>
authors_file_handler <span style="color:#ff79c6">=</span> <span style="color:#8be9fd;font-style:italic">open</span>(authors_file, <span style="color:#f1fa8c">&#34;r&#34;</span>)
authors <span style="color:#ff79c6">=</span> pickle<span style="color:#ff79c6">.</span>load(authors_file_handler)
authors_file_handler<span style="color:#ff79c6">.</span>close()
</code></pre></div><h3 id="split-data-for-training-and-testing">Split Data for Training and Testing</h3>
<p>We can use the built-in <a href="http://scikit-learn.org/stable/modules/generated/sklearn.model_selection.train_test_split.html"><code>train_test_split</code></a> function from scikit-learn to split the data both for training and testing.</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-py" data-lang="py"><span style="color:#ff79c6">from</span> sklearn.model_selection <span style="color:#ff79c6">import</span> train_test_split

features_train, features_test, labels_train, labels_test <span style="color:#ff79c6">=</span> train_test_split(texts, authors, test_size <span style="color:#ff79c6">=</span> <span style="color:#bd93f9">0.1</span>, random_state <span style="color:#ff79c6">=</span> <span style="color:#bd93f9">42</span>)
</code></pre></div><p>The <code>test_size</code> argument is the proportion of data to split into the test, in our case we split 10% for testing.</p>
<h3 id="vectorized-the-strings">Vectorized the Strings</h3>
<p>When working with a text document, we need to vectorize the strings into a list of numbers so it&rsquo;s easier and more efficient to process. We can use the <a href="http://scikit-learn.org/stable/modules/generated/sklearn.feature_extraction.text.TfidfVectorizer.html"><code>TfidfVectorizer</code></a> class to vectorize the strings into a matrix of TF-IDF features.</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-py" data-lang="py"><span style="color:#ff79c6">from</span> sklearn.feature_extraction.text <span style="color:#ff79c6">import</span> TfidfVectorizer

vectorizer <span style="color:#ff79c6">=</span> TfidfVectorizer(sublinear_tf <span style="color:#ff79c6">=</span> True, max_df <span style="color:#ff79c6">=</span> <span style="color:#bd93f9">0.5</span>, stop_words <span style="color:#ff79c6">=</span> <span style="color:#f1fa8c">&#34;english&#34;</span>)
features_train_transformed <span style="color:#ff79c6">=</span> vectorizer<span style="color:#ff79c6">.</span>fit_transform(features_train)
features_test_transformed <span style="color:#ff79c6">=</span> vectorizer<span style="color:#ff79c6">.</span>transform(features_test)
</code></pre></div><p>Word with a frequency higher than the <code>max_df</code> will be ignored. Stop words are also ignored‚Äîstop words are the most common words in a language (e.g. a, the, has).</p>
<h3 id="feature-selection">Feature Selection</h3>
<p>Text can have a lot of features thus it may slow to compute. We can use scikit <a href="http://scikit-learn.org/stable/modules/generated/sklearn.feature_selection.SelectPercentile.html"><code>SelectPercentile</code></a> class to select only the important features.</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-py" data-lang="py">selector <span style="color:#ff79c6">=</span> SelectPercentile(f_classif, percentile <span style="color:#ff79c6">=</span> <span style="color:#bd93f9">10</span>)
selector<span style="color:#ff79c6">.</span>fit(features_train_transformed, labels_train)
selected_features_train_transformed <span style="color:#ff79c6">=</span> selector<span style="color:#ff79c6">.</span>transform(features_train_transformed)<span style="color:#ff79c6">.</span>toarray()
selected_features_test_transformed <span style="color:#ff79c6">=</span> selector<span style="color:#ff79c6">.</span>transform(features_test_transformed)<span style="color:#ff79c6">.</span>toarray()
</code></pre></div><p>The <code>percentile</code> is the percentage of features that we&rsquo;d like to select based on its highest score.</p>
<footer>
        <ul>
            <li>
                <span>Categories:&nbsp;</span><a href="/categories/log/">log</a></li>
            <li>
                <span>Tags:&nbsp;</span><a href="/tags/python/">python</a>,&nbsp;<a href="/tags/machine-learning/">machine-learning</a></li><li><span>Next:&nbsp;</span><a href="/code/set-authorization-header-with-apollo-client/">Set Authorization Header with Apollo Client</a></li><li><span>Previous:&nbsp;</span><a href="/code/react-component-with-dot-notation/">React Component with Dot Notation</a></li></ul>
    </footer></article>
</main>
<footer>
    <small>&copy; Rachel Ombok 2021</small>
    <nav>
        <small><a href="https://github.com/rachelombok">Github</a>
        <a href="https://twitter.com/therachelplan">Twitter</a>
        <a href="https://rachelombok.com/">Main</a></small>
    </nav>
</footer></body>
</html>